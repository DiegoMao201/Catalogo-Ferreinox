<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo Ferreinox - Portfolio Profesional</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body>
    <header class="catalog-header">
        <h1 class="catalog-title">FERREINOX</h1>
        <p class="catalog-subtitle">Catálogo Profesional de Productos</p>
    </header>
    
    <main id="productsContainer" class="catalog-container">
        <div class="loading-placeholder">
            Cargando productos, por favor espera...
        </div>
    </main>

    <script>
        // Variable global para almacenar todos los productos
        let allProducts = [];

        // Función para cargar el archivo CSV de productos
        function loadProductData() {
            const csvFilePath = 'datos_productos.csv';
            
            fetch(csvFilePath)
                .then(response => {
                    if (!response.ok) {
                        throw new Error("No se pudo encontrar el archivo: " + response.statusText);
                    }
                    return response.text();
                })
                .then(csvData => {
                    const results = Papa.parse(csvData, {
                        header: true,
                        skipEmptyLines: true
                    });
                    
                    allProducts = results.data;
                    console.log("Productos cargados:", allProducts);
                    
                    // Mostrar todos los productos con el nuevo diseño
                    displayProducts(allProducts);
                })
                .catch(error => {
                    console.error('Error al cargar los datos:', error);
                    const container = document.getElementById('productsContainer');
                    container.innerHTML = `<div class="error-placeholder">Error al cargar productos. Asegúrate de que 'datos_productos.csv' exista.</div>`;
                });
        }
        
        // Función para generar las estrellas de calificación
        function getRatingStars(productName) {
            let rating = 3; // Calificación base por defecto
            
            if (productName.includes('Advanced') || productName.includes('Premium') || productName.includes('Ceramico') || productName.includes('ABRACOL')) {
                rating = 5;
            } else if (productName.includes('Pro') || productName.includes('Omega')) {
                rating = 4;
            }
            
            return '★'.repeat(rating) + '☆'.repeat(5 - rating);
        }

        // Función para mostrar los productos en el contenedor
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            
            if (products.length === 0) {
                container.innerHTML = `<div class="error-placeholder">No se encontraron productos.</div>`;
                return;
            }
            
            let html = '';
            
            products.forEach(product => {
                // Mapeo de tus datos CSV a los campos del nuevo diseño
                const codigo = product.codigo || 'N/A';
                const tipo = product.subcategoria || 'General';
                const dimensiones = product.presentacion || 'Estándar';
                const grado = product.acabado || 'N/A';
                const empaque = product.rendimiento || 'N/A';
                
                html += `
                <div class="product-card">
                    <div class="product-top-section">
                        <div class="image-container">
                            <img src="images/productos/${product.subcategoria}/${product.imagen}" 
                                 alt="${product.nombre}" 
                                 class="product-image"
                                 onerror="this.src='https://via.placeholder.com/150x150?text=Ferreinox'">
                        </div>
                        <div class="content-container">
                            <div class="product-title">${product.nombre.toUpperCase() || 'PRODUCTO'}</div>
                            <div class="product-info">
                                <span class="product-segment">${product.categoria.toUpperCase() || 'CATEGORÍA'}</span>
                                <span class="product-rating">${getRatingStars(product.nombre)}</span>
                            </div>
                            <div class="product-description">
                                ${product.descripcion || 'Descripción no disponible.'}
                            </div>
                        </div>
                    </div>
                    <div class="specifications-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>CÓDIGO</th>
                                    <th>TIPO</th>
                                    <th>PRESENTACIÓN</th>
                                    <th>ACABADO</th>
                                    <th>RENDIMIENTO</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>${codigo}</td>
                                    <td>${tipo}</td>
                                    <td>${dimensiones}</td>
                                    <td>${grado}</td>
                                    <td>${empaque}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Cargar datos al iniciar la página
        document.addEventListener('DOMContentLoaded', loadProductData);
    </script>
</body>
</html>
